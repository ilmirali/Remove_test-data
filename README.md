Программа из внешнего модуля SQL-запросом получает множество файлов-шаблонов, которые не должны быть удалены.
Далее с сервера из определенной директории - список всех файлов, включая шаблоны.
После чего составляется новое множество, исключающее из полного перечня файлов файлы шаблонов, и выполняется их удаление. 

A program from an external module with a SQL query receives a set of template files that should not be deleted.
Further from the server from a specific directory - a list of all files, including templates.
Then a new set is compiled, excluding template files from the full set of files, and their deletion is performed.